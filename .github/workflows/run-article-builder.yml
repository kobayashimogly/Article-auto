name: Build Articles

on:
  workflow_dispatch:
    inputs:
      keyword:
        description: "Ë®ò‰∫ã„Ç≠„Éº„ÉØ„Éº„ÉâÔºà1„Å§Ôºâ"
        required: true
        type: string

jobs:
  build:
    runs-on: ubuntu-latest

    env:
      GEMINI_API_KEY: ${{ secrets.GEMINI_API_KEY }}
      SERPAPI_KEY: ${{ secrets.SERPAPI_KEY }}
      GMAIL_USER: ${{ secrets.GMAIL_USER }}
      GMAIL_APP_PASSWORD: ${{ secrets.GMAIL_APP_PASSWORD }}

    steps:
      - name: Checkout Repository
        uses: actions/checkout@v3

      - name: Setup Node.js
        uses: actions/setup-node@v3
        with:
          node-version: 20

      - name: Install dependencies
        run: npm install

      - name: Install custom fonts
        run: |
          sudo mkdir -p /usr/share/fonts/truetype/custom
          sudo cp fonts/ShipporiAntique-Regular.ttf /usr/share/fonts/truetype/custom/
          sudo fc-cache -f -v

      - name: Install Playwright Browsers
        run: npx playwright install --with-deps

      - name: Run Builder for keyword
        run: |
          echo "=== üöÄ ÂÆüË°åÈñãÂßã ================================"
          echo "Keyword: ${{ github.event.inputs.keyword }}"
          echo "==============================================="

          node runAll.js "${{ github.event.inputs.keyword }}"

          echo "-----------------------------------------------"
          echo " ‚úî ÂÆå‰∫Ü: ${{ github.event.inputs.keyword }}"
          echo "-----------------------------------------------"
